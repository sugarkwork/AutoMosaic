<Window x:Class="AutoMosaic.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="AutoMosaic" Height="538" Width="555"
        MinHeight="380" MinWidth="420"
        WindowStartupLocation="CenterScreen"
        Background="#1e1e2e" Foreground="#cdd6f4"
        AllowDrop="True"
        Drop="Window_Drop" DragOver="Window_DragOver">

    <Window.Resources>
        <SolidColorBrush x:Key="AccentBrush" Color="#89b4fa"/>
        <SolidColorBrush x:Key="AccentHoverBrush" Color="#74c7ec"/>
        <SolidColorBrush x:Key="SurfaceBrush" Color="#313244"/>
        <SolidColorBrush x:Key="Surface2Brush" Color="#45475a"/>
        <SolidColorBrush x:Key="TextBrush" Color="#cdd6f4"/>
        <SolidColorBrush x:Key="SubtextBrush" Color="#a6adc8"/>

        <Style x:Key="IconButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource SubtextBrush}"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Padding" Value="6"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="4" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource Surface2Brush}"/>
                                <Setter Property="Foreground" Value="{StaticResource TextBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" MinHeight="323"/>
            <RowDefinition/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Main content -->
        <Grid Grid.Row="0" Margin="20,20,20,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Title bar with settings button -->
            <DockPanel Grid.Row="0" Margin="0,0,0,12">
                <Button DockPanel.Dock="Right" Content="⚙" Style="{StaticResource IconButton}"
                        ToolTip="設定" Click="Settings_Click"/>
                <TextBlock Text="AutoMosaic" FontSize="18" FontWeight="SemiBold"
                           Foreground="{StaticResource TextBrush}" VerticalAlignment="Center"/>
            </DockPanel>

            <!-- Drop zone -->
            <Border x:Name="DropZone"
                    Background="{StaticResource SurfaceBrush}"
                    BorderBrush="{StaticResource Surface2Brush}"
                    BorderThickness="2" CornerRadius="12"
                    MinHeight="160" Cursor="Hand"
                    MouseLeftButtonUp="DropZone_Click" Margin="0,45,0,-240" Grid.RowSpan="2">
                <Border.Style>
                    <Style TargetType="Border">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding ElementName=DropZone, Path=Tag}" Value="hover">
                                <Setter Property="BorderBrush" Value="{StaticResource AccentBrush}"/>
                                <Setter Property="Background" Value="#1e1e2e"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Border.Style>
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    <TextBlock Text="📁" FontSize="36" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                    <TextBlock Text="画像またはフォルダをドロップ" FontSize="14"
                               Foreground="{StaticResource SubtextBrush}" HorizontalAlignment="Center"/>
                    <TextBlock Text="クリックでファイルを選択" FontSize="11"
                               Foreground="{StaticResource Surface2Brush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Log area -->
        <Border Grid.Row="1" Background="{StaticResource SurfaceBrush}" CornerRadius="8"
                Padding="10" Margin="20,10,20,0" MinHeight="60">
            <ScrollViewer x:Name="LogScroll" VerticalScrollBarVisibility="Auto">
                <TextBlock x:Name="TxtLog" FontFamily="Consolas" FontSize="11"
                           Foreground="{StaticResource SubtextBrush}" TextWrapping="Wrap"
                           Text="画像をドロップして開始..."/>
            </ScrollViewer>
        </Border>

        <!-- Status bar -->
        <Border Grid.Row="2" Background="{StaticResource SurfaceBrush}" Padding="16,8" Margin="0,12,0,0">
            <DockPanel>
                <ProgressBar x:Name="Progress" DockPanel.Dock="Right" Width="120" Height="6"
                             Visibility="Collapsed" Margin="12,0,0,0"
                             Background="{StaticResource Surface2Brush}"
                             Foreground="{StaticResource AccentBrush}"/>
                <TextBlock x:Name="TxtStatus" Text="Ready"
                           Foreground="{StaticResource SubtextBrush}" FontSize="11" VerticalAlignment="Center"/>
            </DockPanel>
        </Border>
    </Grid>
</Window>
